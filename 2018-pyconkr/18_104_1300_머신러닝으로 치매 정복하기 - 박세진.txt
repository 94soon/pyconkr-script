안녕하세요? 박세진입니다.

오늘 말씀드릴 내용은 머신러닝으로 치매 정복하기라는 제목을 잡았는데요.

제가 잠시 뒤에 말씀 드리겠지만 오늘 말씀 드릴 내용은 저희가 하는 일입니다.

그래서 일부 광고가 될 수 있는데 순수한 마음을 알려드릴 겁니다.

저에 대한 간략한 소개를 드리면요.

지금은 한양대학교에서 박사 과정 중입니다.

아들을 굉장히 좋아하는, 제 아들이 박창민인데 제가 너무 좋아해서 상전이라고 부르는 것 같습니다.

이 발표는 이런 분들에게 소개시켜드리기 위한 내용입니다.

머신러닝을 입문하시고 파이썬으로.

실제로 경험에 들어갈 수 있고 다른 분들에게 도움을 드릴 수 있는 걸,대신 어려운 지식은 최대한 배제하겠습니다.

제가 어려운 것도 아니고 혹시 잘못된 정보를 드릴 수 있기 때문에 어려운 지식은 굉장히 짧게 전달해드리고 내용도 틀릴 수 있기 때문에 그 점은 양해해주시면 감사하겠습니다.

이게 지금 안 나오고, 이걸로 하고 있는데, 알겠습니다.

그리고 오늘 하지 않을 얘기, 오늘 제 발표 단계에 있지 않는 내용은 치매 정복은 못합니다.

제가 과욕을 부려서 제목을 너무 무리하게 잡은 것 같습니다.

그리고 데이터에 대한 얘기는 하지 않겠습니다.

데이터가 사실 가장 중요한데, 머신러닝 기초나 이론에 대한 얘기도 빠져 있습니다.

너무 디테일한 거는 하지 않겠습니다.

차례는 다음과 같이 잡아봤습니다.

치매의 목적과 방향은 어떻게 잡을 것이며 그리고 풀 수 있는 문제는 어떻게 정리할 것이며 그것에 대한 각각의 해결 방안을 제가 이번에 짚어드리겠습니다.

그래서 치매 연구의 목적과 방향입니다.

치매는 치매라는 질환은 대부분 알고 계시지만 인지 장애나 기억 장애가 오는 그러한 일상 용어입니다.

나이가 드신 분들, 사람을 잘 못 알아보시는 그런 분들을 얘기하는데요.

그중에 치매의 질환으로 관련된 거는 굉장히 여러 가지가 있고요.

뇌경색에 의한 치매도 있습니다.

그중에 저희는 알츠하이머라는 질환에 집중하고 있습니다.

그리고 치매질환의 가장 큰 문제는 현재로서는 치매가 걸렸을 때 치료불가라는 것입니다.

대신 늦출 수는 있습니다.

치매와 알츠하이머에 대해서 설명을 드리면 가장 흔한 형태입니다.

치매 환자의 75%입니다.

증상은 제가 여기 적어놓기는 했지만 제가 할 수 있는 건 이것을 읽는 것밖에 없고요.

가장 중요한 건 조직병리학적, 뇌를 꺼낼 수 없지만 치매의, 뇌가 어떤 형태가 되면 치매가 된다는 것을 알 수 있는 여러 가지 중에 하나가 뇌는 나이가 들면 위축이 되기 때문에
그중에서도 특히 일정한 부분이 심하게 위축이 되면 치매가 발생한다고 알려져 있습니다.

그것을 부분용어로 아트로피라고 합니다.

저희는 아트로피에 집중합니다.

알츠하이머를 진단하는 여러 가지 방법 중에 신경학적 진단, MRI나 펫 같은 영상을 찍어서 관찰해서 어떤 소견이 보이는지를 물어보시고 물론 가장 확실한 법은 진단하기 가장 확실한 법은 정신적으로 문제가 있는지 신경계 검사를 통해 할 수 있습니다.

저희의 치매 연구의 목적과 방향은 앞서 설명해드린 것처럼 치료를 할 수 없기 때문에 조기에 발견하는 것이고 치매의 진행을 늦추는 거에 도움을 주는 겁니다.

따라서 좋은 검사 방법은 조기에 싼값에 환자들이 볼 수 있는 좋은 검사 방법을 선택해야 되고 그중에 우리는 MRI를 선택했습니다.

MRI도 여러 가지 영상이 있는데 그중에서도 저희는 이거에 집중하고 있습니다.

저희의 목적은 환자의 MRI 영상에서 뇌위축에 대한 정보를 제공하는 소프트웨어를 개발하는 것입니다.

문제 정의를 해야 되는데 아무 문제나 정의할 수 없습니다.

저희는 제품을 만드는 사람이기 때문에 해결 가능한 문제 정의를 잡아봤습니다.

알츠하이머에 관련된 뇌영역들을 아까 아트로피가 나왔는데 어떤 분들이 잘 아신다고 했기 때문에 그러면 뇌의 모든 부분을 잘 아시는 거는 알 수 없고 뇌의 각 영역을 분할하는 겁니다.

그리고 특징을 추출하고 정상인과 알츠하이머 환자들을 굉장히 많은 수를 모아서 위축의 정보나 형태를 풀고 특징 DB를 만들고 여기서 환자분의 비정상 수치를 산출하는 거로 해봤습니다.

물론 이 방법으로 될 수 있는 건 특히 일부이고 이것만으로 치매의 문제를 풀 수 없지만 저희의 시작은 괜찮았고 다른 여러 기관이나 회사들에서도 비슷한 방법으로 접근한 곳이 있습니다.

기존의 뇌영역 분할들은 이런 것들이 있습니다.


다양한 분석 툴이나 리포트, 시각화를 적용하고 분석 시간은 현재 10분 정도입니다.

프리서퍼FreeSurfer)는 공개소프트웨어인데 분석시간이 6시간에서 12시간 정도 걸리기 때문에 거의 연구용으로만 사용이 됩니다.

이 두 가지 소프트웨어가 매우 괜찮습니다.

단 우리의 차별점은 병원 진료 과정에서 사용 가능한 수행 속도라는 것이고 외국인이 아닌 한국인의 정상인 범위와 비교한 위험도를 제시한 겁니다.

그리고 뇌 영역을 분할할 때 굉장히 자세한 형태로 시각화하는 것입니다.

합리적인 해결 방법을 찾아야되는데 저희가 찾은 방법은 일단 기존 소프트웨어의 문제점은 매우 오래 걸리고 문제가 너무 많고 약간 부정확합니다.

그리고 현실의 굉장히 복잡한 데이터를 완전 히 반영하고 있지 않습니다.

여러 가지 형태, 많은 변형들이 있는데 그것을 다 반영하고 있지 않습니다.

그래서 저희는 획기적으로 빠르게 하고 중간 단계를 완전히 최소화하며 현실의 굉장히 다양한 데이터에서 모두 실험하는 것으로 잡았고 그것을 하기 위해서 머신러닝이라는 것을 사용함으로써 GPU를 지원하기 때문에 중간 과정에서는 엔드 투 엔드를 지향하며 이상에서 나온 다양한 데이터를 모두 학습하는 방법을 선택하였습니다.

아까 굉장히 복잡한 MRI 자료가 있다고 말씀드렸고요.

MRI를 추출하고 위치를 맞추고 돌아가거나 회전된 형태의 얼라인먼트를 진행한 다음에 MRI 자기장의 테두리 안에서,자기장이 사람에 의해서 변형될 텐데 그런 것을 줄여주는 걸 진행하고 스케일이 다 다르기 때문에 단체 스케일로 맞춰준 것 그리고 마지막에
실제 우리가 주목해야 하는 뼈나 어떤 둘러싸고 있는 액체가 있는데 그런 것들을 제외한 대부분만을 진행하는 것입니다.

여기서 끝이 아니라 또 이것들을 어떤 정규화되어 있는 형태로 일부러 찌그러뜨려서 시뮬레이션을 정교화 시킨 다음에 어떤 위치에서 어떤 영역에 존재할 것이라는 가정 하에 위치를 인식하는데, 그렇기 때문에 6시간이 걸리는 것입니다.

시간이 지나면 교체하고 퍼슬리케이션이라는 단어는, CNN 모듈이 있고 좀 더 상세히 설명을 드리겠지만 이것들을 활용하게 됐습니다.

네트워크 형태는 이것은 사실 이 그림을 제가 쓰고 있는 거는 본문에 나오는 것들을 가져온 건데, 전처리로 마무리하는 경우가 많은데 이 전처리 중에, 혹은 위치적으로 형태가, 기존의 문제들을 알고리즘으로 처리했습니다.

하지만 요즘은 잘 하지 않고요.

이러한 변형들이 사실 알고 봤더니 하나의 정규화된 것으로 이게 사실 노이즈가 많고 변형이 된 레이터를 노이즈가 없고, 그런 역할을 수행하고 있다고 생각하고 이것을 정규화된 내용으로 실질적으로 그렇게 하지 않지만 내부적으로 그렇게 작동한다 생각하고 결과적으로도 아주 변형이 심한 데이터를 하고 있습니다.

파이썬을 이용한 영상처리는 다음과 같은 것들입니다.

SK이미지라는 툴이 있는데요.

특히 이거는 많이 쓰시는 거는 다 데이터를 입력받기 때문에 굳이 다른 걸 사용하지 않고요.
속도의 경우에는 사실 제가 이런 모델을 구성하는 것이 좀 많아서 연구하는 입장에서는 꼭 그런 수준의, SK이미지를 사용합니다.

그리고 SK이미지를 만든 몇 가지는 필요한 기능들이기 때문에.

아니면 데이터 오리엔테이션을 한다든가 저장한다든가 하는 모든 가능한 파일이 반드시 필요합니다.

그리고 전처리나 후처리도 아주 언급하지 않기 때문에.

그리고 오픈CV는 아까 많이 썼던 것 같은.

그리고 저희가 풀어야 될 이 뇌의 어떤 상대적 위치는 여러 가지 방법이 있을 수 있고
요즘은 그렇게 하지 않고 정규화와 관계없이 어떤 위치에 어떤 부분이 있는지 찾아내기 때문에 이 방법으로 사용하기로 했습니다.

여러 가지 방법이 있지만 가장 대표적으로는 오브젝트 디텍션, 요즘에는 많이 알려져 있는 건데.

이 네트워크를 쓰고 있고요.

굳이 비교를 하자면 위치는 클러스터를 통해서 하고 있고 크기를 인식하는 것은 박스 리그레션을 인식하고 픽셀의 개수 혹은 영역이 네거이트, 백그라운드가 되는 오브젝트에 대한 처리는 명시적으로 알고리즘에 셀렉션을 하는 알고리즘을 하고 이거는 로즈 웨이팅이라는 걸 합니다.

특징이므로는 사람이 붙어 있을 때 두 사람이 붙어 있으면 거의 한 사람을 얘기하는 겁니다.
픽셀 클래식테이션을 저희는 선택했고요.

실제로 작동하는 원리는 이미지를 세그멘테이션하는 것으로 그중에 이거를 이용해서 가장 작은 어떤 영역을 뭉쳐져 있는 영역을 찾는 것으로 많이 하는데요.

픽셀 하나하나를 조각조각 긁어내와서 하나하나를 하는 것처럼 작동을 하고요.

이거를 학습하기 위해서 하다 보면 가장 어려운 문제가 데이터 임밸런스 문제입니다.

거의 90:1 정도, 10:1 정도로요.

이것을 하기 위해서 여러 가지 방법이 있는데 우선 카테고리가 단순히 그냥 레이팅을 좌변수로 주고 큰 거에서는 레이팅을 1로 줘서 로스가 거의 에러가 적기 때문에
나중에 업데이트도 덜 하는 식으로 갑니다.

셀렉트를 한 다음에 영역을 측정하는 건데요.

그런데 이거를 로스에 했을 때는 두 개의 세그멘테이션이 겹치는 역량을 보는 거기 때문에 더 잘 겹쳐지도록 하고.

다만 문제는 수식이 이런 형태로 보시면 이거로 나오는데 밑에 보시면 이게 0에 가까워지면 굉장히 큰값을 가져가서 안 되는 수가 많이 있습니다.

따라서 이것에 대한 정의가 좀 필요하고 T에 따라서 로스 펑션은 컨디션으로 줘서
T가 어떤 수보다 클 때는 다이스 방식으로 해 볼 수 있습니다.

그리고 제가 쓴 네트워크의 파일 이름은 하이 ResNet이라는 게 있는데요.

그리고 아까 말씀드렸다시피 가장 중요한 것은 임상 검증인데요.

다양한 장비의 환경에서 재현성, 일관성을 검증해야 되는데 그중에서도 어려운 것은 어떠한 A 문제나 그러니까 치매가 아니라는 것을 알 수 없는 경우가 굉장히 많습니다.

그렇게 바로 알 수 없다면 중간 단계인 B만으로도 확실히 제시함으로써 의료진이 판단하게끔 해서 하는 것이 저희의 작전이고 실제로 저희 회사 전체의, 이렇게 말하면 위험하지만 저희 회사는 그렇습니다.

이제 결론을 내겠습니다.

저희가 왜 치매 연구를 하는가? 저희는 치매 예방을 위해서 치매의 환자를 잡아내는 걸 하고 있고요.

그것을 판매할 수 있는 툴을 제공하는 것을 목표로 하고 있습니다.

해결 가능한 문제를 정의하였고 뇌 위축을 측정하고 그것으로 정산 환자와 비교한 비정상 수치를 제시하는 게 저희의 목적이고 정교한 걸 해야 되는데 사용한 방법으로는 머신러닝이 있습니다.

그리고 부분적인 예시를 제시하고 있습니다.

이상으로 저희 발표는 여기까지.

앞으로는 이런 것도 저희가 진행할 사항입니다.

감사합니다.